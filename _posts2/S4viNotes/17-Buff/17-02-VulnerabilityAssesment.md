## Vulnerability Assessment {-}

### Buscamos exploit para Gym Management Software {-}

```bash
searchsploit Gym Management
```

Aqui vemos varias cosas

- SQL Injection
- Authentication Bypass
- Stored Cross Site Scripting
- Unauthenticated Remote Code Execution

Vamos a ver el script en python para el Unauthenticated Remote Code Execution

```bash
cd content
searchsploit -m 48506 .
mv 48506.py gym_management.py
cat gym_management.py
```

Analyzamos el script y lo comprobamos con firefox al mismo tiempo:

1. Ir a la pagina /upload.php que no mirra para una session de usuario authentificado

    - `http://10.10.10.198:8080/upload.php` Nos pone undefined id parameter.

1. Ponerle un parametro id en la GET request que appunte en el fichero deseado

    - `http://10.10.10.198:8080/upload.php?id=EEEE` nos hace algo.

1. Bypasseamos un archivo con una doble extension. (.php.png)
1. Bypasseamos el type check modificando el **Content-type** del fichero con `image/png`
1. Se pone un codigo malicioso en el body del fichero

Estos passos se pueden facilmente hacer a mano pero aqui vamos a utilizar el proprio exploit.


