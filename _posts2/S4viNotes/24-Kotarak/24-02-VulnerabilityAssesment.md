## Vulnerability Assessment {-}

### HTML Injection, XSS y SSRF {-}

Intentamos con etiquetas html y script... vemos que el servicio es vulnerable a html injection y XSS pero no podemos hacer muchas cosas con esto.

Vamos a ver si es vulnerable a un **SSRF** (Server Side Request Forgery). Si le ponemos `localhost:22` la pagina nos reporta la cabezera des servicio
ssh. Vamos aqui a utilizar WFUZZ para enumerar los puertos internos que estan abiertos.

#### Uzando WFUZZ para enumerar los puertos internos abiertors {-}

```bash
wfuzz -c -t 200 --hc=404 -z range,1-65535 "http://10.10.10.55:60000/url.php?path=http://localhost:FUZZ"
```

Aqui vemos que hay muchas respuestas que nos dan 2 caracteres de respuesta y esto lo vamos a ocultar.

```bash
wfuzz -c -t 200 --hh=2 --hc=404 -z range,1-65535 "http://10.10.10.55:60000/url.php?path=http://localhost:FUZZ"
```

Aqui vemos muchos puertos addicionales que no nos reporto el scanning de NMAP como los puertos

- 320
- 90
- 888
- 110
- 200
- 3306 (mysql)

Verificamos estos puertos con la web y encontramos cosas muy interesante como un panel de administracion en el puerto 320 y un listador
de ficheros en el puerto 888. Encontramos un fichero backup y lo miramos desde la web `http://10.10.10.55:60000/url.php?path=http://localhost:888/?doc=backup`
y mirando el codigo fuente encontramos informaciones muy interesante en el XML. Vemos un usuario admin y su contrase√±a.

Como vemos que el fichero XML es un fichero de configuracion tomcat miramos si las credenciales son validas en el servicio del puerto 8080
